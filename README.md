# NATS-PUBLISHER

## назначение

Микросервис создан для тестирования [neutral-jungle-creep/nats-subscriber](https://github.com/neutral-jungle-creep/nats-subscriber).
Каждый N секунд сервис генерирует новый заказ и отправляет его в канал. Для генерации
используется библиотека [brianvoe/gofakeit](https://github.com/brianvoe/gofakeit).
Переодичность создания заказов можно задать в файле конфигурации.

## инструкция настройки и запуска

Для работы сервиса требуется иметь доступ к серверу nats-streaming.
Пример команды запуска сервера nats-streaming в Docker контейнере:

```
docker run --nats_orders -p 4222:4222 -p 8222:8222 -d nats-streaming
```

Чтобы запустить сервис, нужно набрать в консоли в папке с проектом команду:

```
go run ./cmd/nats-publisher.go -p my_folder -c my_config
```

Если флаги не указаны, сервис будет искать файл конфигурации в пути по умолчанию: директория **configs**, файл **config**.
Для того чтобы указать свои путь и название файла конфигурации можно добавить флаги в команду:

- **--path** или **-p** - путь до директории с файлом конфигурации
- **--config** или **-с** - название файла конфигурации без расширения

Для чтения файла конфигурации используется библиотека [spf13/viper](https://github.com/spf13/viper). Рекомендуется
выбрать
один из поддерживаемых библиотекой форматов конфигурации, например - **yml**, **json** или **toml**.
Пример:

```toml
[nats]
cluster = "test-cluster"
client = "stan-pub"
URL       = "127.0.0.1:4222"
subj = "test"

[sys]
sleep = 25
```

### пояснения к полям:

**nats**

+ **cluster** - имя сервера кластера
+ **client** - уникальное имя клиента
+ **URL** - ссылка для подключения к серверу nats-streaming
+ **subj** - название канала, на который подписывается клиент

**sys**

+ **sleep** - периодичность генерации заказа в секундах
+ 

